<!DOCTYPE html>
<html lang="zh_cn">
  <head>
    <meta charset="utf-8">
    <script src="/static/jquery/jquery.min.js"></script>
    <script src="/static/semantic-ui/semantic.min.js"></script>
    <link rel="stylesheet" href="/static/semantic-ui/semantic.min.css">
    <link rel="stylesheet" href="/static/filedock/index.css">
    <title>FileDock</title>
    <script>
        function setCookie(cname,cvalue,exdays)
        {
            var d = new Date();
            d.setTime(d.getTime()+(exdays*24*60*60*1000));
            var expires = "expires="+d.toGMTString();
            document.cookie = cname + "=" + cvalue + "; " + expires;
        }
        function getCookie(cname){
          var name = cname + "=";
          var ca = document.cookie.split(';');
          for(var i=0; i<ca.length; i++) {
              var c = ca[i].trim();
              if (c.indexOf(name)==0) { return c.substring(name.length,c.length); }
          }
          return "";
        }
    </script>
  </head>
  <body>

    <script>
        function login() {
            username = document.getElementById("username").value;
            password = document.getElementById("password").value;

            var settings = {
                "url": "/api/v1/user/login",
                "method": "POST",
                "timeout": 0,
                "headers": {
                    "Content-Type": "application/json"
                },
                "data": JSON.stringify({
                    "username": username,
                    "password": password
                }),
            };

            $.ajax(settings).done(function (response) {
                if(response.success){
                    setCookie("uid", response.data.uid, 365);
                    setCookie("session_id", response.data.session_id, 365);
                    window.location.href="/";
                }
                else{
                    alert("账号或密码错误");
                }
            });
        }
    </script>
    <form class="ui form">
        <div class="field">
            <label>用户名</label>
            <input type="text" id="username" placeholder="username">
        </div>
        <div class="field">
            <label>密码</label>
            <input type="password" id="password" placeholder="password">
        </div>
        <button class="ui button" type="submit" onclick="login()">登录</button>
    </form>
  </body>
</html>